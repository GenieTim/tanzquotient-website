{% extends "basis.html" %}

{% load static i18n %}
{% load survey_tags %}


{% block lead_title %}
    {% trans "Survey Results" %}
{% endblock %}

{% block main_content %}
    <div class="container">
        {% if survey.title %}
            <h1>{{ survey.title }}</h1>
        {% endif %}

        <!-- Filter by offering -->
        {% if offerings|length > 1 %}
            <div class="my-2">
                <a href="{% url "survey:survey_results" survey.id %}"
                   class="btn btn-sm mb-1 {% if not selected_offering %} btn-success {% else %} btn-outline-success {% endif %}"
                   aria-current="page">{% trans "All offerings" %}</a>
                {% for offering in offerings %}
                    <a href="{% url "survey:survey_results" survey.id %}?offering_id={{ offering.id }}"
                       class="btn btn-sm mb-1 {% if selected_offering and selected_offering == offering %} btn-success {% else %} btn-outline-success {% endif %}">{{ offering.name }}</a>
                {% endfor %}
            </div>
        {% endif %}

        <!-- Filter by course -->
        {% if selected_offering and courses|length > 1 %}
            <div class="my-2">
                <a href="{% url "survey:survey_results" survey.id %}?offering_id={{ selected_offering.id }}"
                   class="btn btn-sm mb-1 {% if not selected_course %} btn-success {% else %} btn-outline-success {% endif %}"
                   aria-current="page">{% trans "All courses" %}</a>
                {% for course in courses %}
                    <a href="{% url "survey:survey_results" survey.id %}?offering_id={{ selected_offering.id }}&course_id={{ course.id }}"
                       class="btn btn-sm mb-1 {% if selected_course and selected_course == course %} btn-success {% else %} btn-outline-success {% endif %}">{{ course.name }}</a>
                {% endfor %}
            </div>
        {% endif %}


        {% for group in survey.questiongroup_set.all %}
            <div class="mb-4">
                {% if group.title %}
                    <h2>{{ group.title }}</h2>
                {% endif %}
                <div class="row row-cols-1 row-cols-lg-2 g-4">
                    {% for question in group.question_set.all %}
                        <div class="col">
                            {% survey_question question selected_offering selected_course %}
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock main_content %}
