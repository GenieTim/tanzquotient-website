{% load i18n %}
{% with count=course.get_free_places_count show=course.show_free_places_count %}
    {% if course.is_open_class %}
        <i class="fa fa-connectdevelop fa-lg"></i> {% trans "Open class" %}
    {% elif course.is_external %}
        <i class="fa fa-handshake-o fa-lg"></i> {% trans "External partner course" %}
    {% endif %}
    {% if course.is_subscription_allowed %}
        {% if display_link %}
            <a href="{% url 'courses:subscription' course.id %}#subscription">Anmelden</a>
        {% endif %}
        <div class="subscription_info">
            {% if course.type.couple_course %}
                {% if count != None %}
                    {% if count.man <= 0 %}
                        {% include "courses/snippets/subscription_info_waiting_list.html" with gender_icon='mars' gender_singular='Mann' gender_plural='Männer' %}
                    {% else %}
                        <span class="subscription_info_item">
                    {% if show.man %}
                        <i class="fa fa-mars"></i>
                        <span class="badge">{{ count.man }} frei</span>
                    {% endif %}
                    </span>
                    {% endif %}
                    {% if count.woman <= 0 %}
                        {% include "courses/snippets/subscription_info_waiting_list.html" with gender_icon='venus' gender_singular='Frau' gender_plural='Frauen' %}
                    {% else %}
                        <span class="subscription_info_item">
                    {% if show.woman %}
                        <i class="fa fa-venus"></i>
                        <span class="badge">{{ count.woman }} frei</span>
                    {% endif %}
                    </span>
                    {% endif %}
                {% else %}
                    {% if course.men_needed %}
                        {% include "courses/snippets/subscription_info_missing_gender.html" with gender_icon='mars' gender_singular='Mann' gender_plural='Männer' gender_op_singular='Frau' gender_op_plural='Frauen' %}
                    {% endif %}
                    {% if course.women_needed %}
                        {% include "courses/snippets/subscription_info_missing_gender.html" with gender_icon='venus' gender_singular='Frau' gender_plural='Frauen' gender_op_singular='Mann' gender_op_plural='Männer' %}
                    {% endif %}
                {% endif %}
            {% else %}
                {% if count != None %}
                    <span class="subscription_info_item">
                {% if show.total %}
                    <span class="badge">{{ count.total }} frei</span>
                {% elif count.total <= 0 %}
                    <em>(Warteliste)</em>
                {% endif %}
                </span>
                {% endif %}
            {% endif %}
        </div>
    {% else %}
        {% if count != None and count.total <= 0 %}
            {% include "courses/snippets/subscription_info_overbooked.html" %}
        {% endif %}
    {% endif %}
{% endwith %}