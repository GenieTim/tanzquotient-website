{% extends "basis.html" %}
{% load i18n %}
{% load bootstrap3 %}

{% block content_title %}
    {% trans "Finance" %}
{% endblock %}

{% block main_content %}
    <div class="container">
        {% url 'payment:offering_finance_index_view' as offering_finance_index_view %}
        <p>{% blocktrans %}<a href="{{ offering_finance_index_view }}"><i class="fa fa-arrow-circle-left fa-lg"></i> Go back to offering overviews</a>{% endblocktrans %}
        </p>
        <h2>Unpaid Subscriptions in {{ offering }}
            <small>{{ offering.period|default:'' }}</small>
        </h2>

        <div class="panel panel-default">
            <div class="panel-body">
                <table class="table">
                    <thead>
                    <th>{% trans "USI" %}</th>
                    <th>{% trans "Name" %}</th>
                    <th>{% trans "E-Mail" %}</th>
                    <th>{% trans "Amount" %}</th>
                    <th>{% trans "Amount Due" %}</th>
                    <th>{% trans "Course" %}</th>
                    </thead>
                    <tbody>
                    {% for subscription in subscriptions %}
                        {% if not subscription.payed %}
                            <tr>
                                <td>{{ subscription.usi }}</td>
                                <td>{{ subscription.user.get_full_name }}</td>
                                <td>{{ subscription.get_user_email }}</td>
                                <td>{{ subscription.get_price_to_pay }} CHF</td>
                                <td>{% if not subscription.payed %}{{ subscription.get_price_to_pay }}{% else %}
                                    0{% endif %}
                                    CHF
                                </td>
                                <td>{{ subscription.course }}</td>
                                <td>
                                    <form method="post">
                                        {% csrf_token %}
                                        <input type="hidden" name="subscription" value="{{ subscription.id }}">
                                        {% buttons %}
                                            <button type="submit" class="btn btn-default btn-sm">
                                                {% trans "Send Reminder" %}
                                            </button>
                                        {% endbuttons %}
                                    </form>
                                </td>
                            </tr>
                        {% endif %}
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock main_content %}
